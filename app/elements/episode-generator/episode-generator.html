<dom-module id="episode-generator">
  <style>
   paper-fab {
     position: fixed;
     right: 16px;
     top: 16px;
     z-index: 3;
     background-color: var(--trek-highlight-color);
   }
   
  </style>
  <template>
    <episode-card episode="[[_episode]]">
      
    </episode-card>

    <paper-fab icon="refresh" on-tap="getRandomEpisode"></paper-fab>
    
  </template>


  <script>

   Polymer({
     is: "episode-generator",

     behaviors: [
       Polymer.NeonAnimatableBehavior
     ],
     
     properties: {

       entryAnimation: {
         value: 'scale-up-animation'
       },
       exitAnimation: {
         value: 'fade-out-animation'
       },

       settings: {
         type: Object,
         readOnly: true
       },
       
       _episode: {
         type: Object,
         notify: true
       }

     },

     /*
        newEpisode : function(){

        var seriesBin = [];

        // iterate through, create series key bin from which to select
        // this probably makes certain configurations less random, or some other obscure point
        // don't care
        console.log("randomSettings: ", this.randomSettings);
        for (var key in this.randomSettings) {
        if (this.randomSettings.hasOwnProperty(key)) {
        if (this.randomSettings[key]){
        seriesBin.push(key);
        }
        }
        }

        // choose which series: note all series have equal chance of being chosen,
        // not waited by number of episodes
        var seriesIndex = getRandomInt(0, seriesBin.length - 1);
        // lookup the series from our episode json data, using the index on the bin
        var series = this.episodes[seriesBin[seriesIndex]];


        console.log("series: ", series);
        console.log("series index: ", seriesIndex);
        console.log("series length: ", series.length);

        var max = series.length - 1;
        var episodeIndex = getRandomInt(0, max);
        //        console.log("episode index: ", episodeIndex);

        // now get the actual episode index
        this.randomEpisode = series[episodeIndex];

        this.setEpisode(this.randomEpisode, seriesBin[seriesIndex]);


        // we have our random episode ready for display
        //        this.episode = this.randomEpisode;
        //        this.episodeTitle = this.episode.title;

        return this.episode;

        },
      */
     
     getRandomEpisode: function(){

     },
     
     _getRandomInt: function(min, max) {
       return Math.floor(Math.random() * (max - min + 1)) + min;
     },

     ready: function(){
       this._episode = this.getRandomEpisode();
     }

   });

  </script>
  
</dom-module>
