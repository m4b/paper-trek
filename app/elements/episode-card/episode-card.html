<dom-module id="episode-card">
  <style>
   .body {
     padding: 16px;
   }

   paper-material {
     margin: 16px;
     background-color: var(--trek-primary-text-color);
   }
   
   paper-item {
     background-color: var(--trek-header-color);
     color: var(--trek-primary-text-color);
     margin-top: 0px;
     padding: 16px;
     margin-bottom: 16px;
   }

   h1 {
     text-decoration: none;
     font-weight: normal;
   }

   .text-accent {
     color: #000;
     opacity: .54;
   }

   a {
     text-decoration: none;
     color: var(--trek-highlight-color);
   }

  </style>

  <template>
    <paper-material elevation="3" id="core_card" class="layout vertical">
      <paper-item>
        <content></content>
        <h1>{{episode.title}}</h1>
      </paper-item>
      <section class="body">
        <span class="episode_body" class="flex"><span>{{episode.seriesPretty}}</span>
          <p class="episode_body">
            <span class="text-accent">S</span><span>{{episode.season}}</span>
            <span class="text-accent">E</span><span>{{episode.episode}}</span>
          </p>
        </span>
          <iron-image id="thumb" style="width: 300px; height: 300px;" src="[[_imagePath]]" preload sizing="cover"></iron-image>
        <div class="episode_text" hero hero-id="heroBottom" cross-fade>
          <h3 class="layout horizontal around-justified">
            <span class="flex">
              <em>Stardate: </em>
              <span>{{episode.stardate}}</span>
            </span>
          </h3>
          <p><em>Airdate: </em><span>{{episode.airdate}}</span></p>
          <p><a href$="{{episode.href}}">Memory Alpha</a></p>
        </div>
      </section>
    </paper-material>

  </template>
  <script>

   Polymer({
     is: "episode-card",

     
     behaviors: [
       Polymer.NeonAnimationRunnerBehavior
     ],

     properties: {

       animationConfig: {
         type: Object,
         value: function() {
           return {
             name: 'fade-out-animation',
             node: this
           }
         }
       },
       
       episode: {
         type: Object,
         notify: true,
         reflectAttribute: true,
         observer: '_episodeChanged',
         value: function(){
           return {
             title: 'Untitled',
             seriesPretty: 'None',
             series: 'none',
             season: 0,
             episode: 0,
             thumb: {
               name: '../../images/troll_fish.jpg'
             },
             stardate: 'Unknown',
             airdate: 'Never',
             href: 'http://example.com'
           };
         }
       },

       _imagePath: {
         type: String,
         notify: true
       }

     },

     animate: function() {
       console.log("card animating");
       this.playAnimation();
     },

     listeners: {
       'neon-animation-finish': '_onNeonAnimationFinish'
     },
     
     _onNeonAnimationFinish: function() {
       console.log('animation finish!');
     },
     
     _episodeChanged: function(){
       console.log("episode changed");
       this._imagePath = "../../images/episodes/" + this.episode.thumb.name;
       console.log("this._imagePath: ", this._imagePath);
     },
     
     ready: function(){
       console.log("episode-card ready");
     }
   });

  </script>

</dom-module>
